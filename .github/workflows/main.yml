name: SSH VPS

on:
  workflow_dispatch:

jobs:
  sshvps:
    runs-on: ubuntu-latest
    steps:
      - name: Setup SSH Server
        run: |
          sudo apt update
          sudo apt install -y openssh-server wget curl
          sudo service ssh start

          echo "Creating SSH user..."
          sudo useradd -m govinda
          echo 'govinda:password123' | sudo chpasswd
          sudo usermod -aG sudo govinda

          echo "Installing Cloudflared..."
          wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64
          chmod +x cloudflared-linux-amd64
          ./cloudflared-linux-amd64 tunnel --url ssh://localhost:22 --no-autoupdate
